<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Theme Wordle</title>
<style>
body { background:#121212; color:white; font-family:system-ui; margin:0; padding:16px; }
.app { max-width:420px; margin:auto; }
h1 { text-align:center; }
.hint { background:#1e1e1e; padding:14px; border-radius:10px; text-align:center; margin-bottom:16px; font-size:1.1rem; }
.board { display:grid; gap:10px; margin-bottom:16px; }
.row { display:grid; gap:8px; }
.cell { background:#1e1e1e; border:2px solid #333; height:56px; font-size:1.6rem; display:flex; align-items:center; justify-content:center; font-weight:bold; }
.correct { background:#4caf50; }
.present { background:#fbc02d; color:black; }
.absent { background:#555; }
input, button { width:100%; height:56px; font-size:1.2rem; border-radius:10px; border:none; margin-bottom:10px; }
input.invalid { border:2px solid #ff4c4c; }
button { font-weight:bold; }
#msg { text-align:center; color:#fbc02d; margin-bottom:10px; }
#stats { margin-top:10px; text-align:center; }
#copyResult { margin-top:10px; }
</style>
</head>
<body>
<div class="app">
<h1>Theme Wordle</h1>
<div class="hint" id="hint">Loading‚Ä¶</div>
<div class="board" id="board"></div>
<input id="input" placeholder="Type your word">
<button id="validate">Validate</button>
<div id="msg"></div>
<button id="copyResult" class="hidden">Copy result</button>
<div id="stats">
  <div>Played: <span id="played">0</span></div>
  <div>Won: <span id="won">0</span></div>
  <div>Win %: <span id="winpercent">0</span>%</div>
  <div>Win Streak: <span id="streak">0</span></div>
</div>
</div>

<!-- 1Ô∏è‚É£ Charger ton themes.js avec les 3000 mots -->
<script src="themes.js" defer></script>

<!-- 2Ô∏è‚É£ Script principal -->
<script defer>
window.onload = () => {
  const MAX_TRIES = 3;
  if(!THEMES){ alert("themes.js not loaded!"); return; }

  const seed = Math.floor(Date.now()/86400000);
  const themeNames = Object.keys(THEMES);
  const theme = themeNames[seed % themeNames.length];
  const words = THEMES[theme].map(w=>w.toUpperCase());
  const word = words[seed % words.length];

  const board = document.getElementById("board");
  const input = document.getElementById("input");
  const validate = document.getElementById("validate");
  const msg = document.getElementById("msg");
  const copyBtn = document.getElementById("copyResult");

  document.getElementById("hint").textContent = `HINT: ${theme} ‚Ä¢ ${word.length} letters`;

  // Stats
  let stats = JSON.parse(localStorage.getItem('themeWordleStats')) || {played:0, won:0, streak:0};
  function updateStatsDisplay(){
    document.getElementById('played').textContent = stats.played;
    document.getElementById('won').textContent = stats.won;
    document.getElementById('streak').textContent = stats.streak;
    document.getElementById('winpercent').textContent = stats.played ? Math.round(stats.won/stats.played*100) : 0;
  }
  updateStatsDisplay();
  function updateStats(win){
    stats.played++;
    if(win){ stats.won++; stats.streak++; } else stats.streak=0;
    localStorage.setItem('themeWordleStats', JSON.stringify(stats));
    updateStatsDisplay();
  }

  const ALL_WORDS = new Set(words);
  let tries = 0;
  let emojis = [];

  // Cr√©ation board
  for(let i=0;i<MAX_TRIES;i++){
    const row = document.createElement("div");
    row.className = "row";
    row.style.gridTemplateColumns = `repeat(${word.length},1fr)`;
    for(let j=0;j<word.length;j++){
      row.appendChild(document.createElement("div")).className="cell";
    }
    board.appendChild(row);
  }

  function fillRow(row, guess){
    guess.split('').forEach((letter,i)=>{
      setTimeout(()=>{
        const cell = row.children[i];
        cell.textContent = letter;
        if(letter === word[i]) cell.classList.add("correct");
        else if(word.includes(letter)) cell.classList.add("present");
        else cell.classList.add("absent");
      }, i*600);
    });
  }

  function processGuess(){
    const guess = input.value.toUpperCase().trim();
    if(guess.length !== word.length) return;

    input.classList.remove('invalid');
    msg.textContent="";

    const valid = ALL_WORDS.has(guess);
    if(!valid){
      input.classList.add('invalid');
      msg.textContent="Word not in theme! (counts as attempt)";
    }

    const row = board.children[tries];
    fillRow(row, guess);

    // Emoji line pour partager
    let line="";
    [...row.children].forEach((cell,i)=>{
      if(guess[i] === word[i]) line+="üü©";
      else if(word.includes(guess[i])) line+="üü®";
      else line+="‚¨õ";
    });
    emojis.push(line);

    tries++;
    input.value="";

    if(guess === word){
      input.disabled=true; validate.disabled=true;
      updateStats(true);
      copyBtn.classList.remove('hidden');
    } else if(tries>=MAX_TRIES){
      input.disabled=true; validate.disabled=true;
      updateStats(false);
      copyBtn.classList.remove('hidden');
    }
  }

  validate.onclick = processGuess;
  input.addEventListener('keypress', e=>{if(e.key==='Enter') processGuess();});

  copyBtn.onclick = ()=>{
    navigator.clipboard.writeText(`Theme Wordle\n${emojis.join("\n")}\nNo spoilers`);
    msg.textContent = "Result copied!";
  };
};
</script>
</body>
</html>
