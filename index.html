<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Theme Wordle</title>

<style>
body {
  background:#121212;
  color:#fff;
  font-family:system-ui;
  margin:0;
  padding:16px;
}
.app {
  max-width:420px;
  margin:auto;
}
h1 { text-align:center; margin-bottom:8px; }

.hint {
  background:#1e1e1e;
  padding:14px;
  border-radius:10px;
  text-align:center;
  margin-bottom:16px;
  font-size:1.1rem;
}

#timerLine { font-weight:600; margin-bottom:6px; }
#themeLine { opacity:0.9; }

.board {
  display:grid;
  gap:10px;
  margin-bottom:16px;
}
.row {
  display:grid;
  gap:8px;
}
.cell {
  background:#1e1e1e;
  border:2px solid #333;
  height:56px;
  font-size:1.6rem;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:bold;
}

.correct { background:#4caf50; border:none; }
.present { background:#fbc02d; color:black; border:none; }
.absent  { background:#555; border:none; }

.controls,
.copy-container {
  display:flex;
  justify-content:center;
  gap:8px;
  margin-bottom:10px;
}

input, button {
  width:140px;
  height:44px;
  font-size:1rem;
  border-radius:10px;
  border:none;
}

input.error {
  background:#3a1515;
  border:2px solid #ff5252;
  color:#ffb3b3;
}

button {
  font-weight:bold;
  cursor:pointer;
}

#msg {
  text-align:center;
  color:#fbc02d;
  margin-bottom:10px;
  min-height:1.2em;
}

#stats {
  margin-top:16px;
  font-size:0.95rem;
  text-align:center;
  opacity:0.9;
}

.hidden { display:none; }

.win { animation: pop 1s ease-out; }
@keyframes pop {
  0% { transform:scale(0.9); }
  60% { transform:scale(1.1); }
  100% { transform:scale(1); }
}

.lose { animation: shake 1s; }
@keyframes shake {
  0% { transform:translateX(0); }
  25% { transform:translateX(-5px); }
  50% { transform:translateX(5px); }
  75% { transform:translateX(-5px); }
  100% { transform:translateX(0); }
}
</style>
</head>

<body>
<div class="app">

<h1>Theme Wordle</h1>

<div class="hint">
  <div id="timerLine">Loadingâ€¦</div>
  <div id="themeLine"></div>
</div>

<div class="board" id="board"></div>

<div class="controls">
  <input id="input" placeholder="Word" />
  <button id="validate">Validate</button>
</div>

<div id="msg"></div>

<div class="copy-container">
  <button id="copy" class="hidden">Copy result</button>
</div>

<div id="stats">
  Played: <span id="played">0</span> â€¢
  Wins: <span id="wins">0</span> â€¢
  Win %: <span id="rate">0</span>% â€¢
  Streak: <span id="streak">0</span>
</div>

</div>

<script src="themes.js"></script>

<script>
/* ---------- WORD ---------- */
const now = new Date();
const intervalIndex = now.getHours() < 12 ? 0 : 1;
const dateKey = now.getFullYear()*10000 + (now.getMonth()+1)*100 + now.getDate();
const seed = dateKey * 2 + intervalIndex;
const rng = s => (Math.sin(s)*10000)%1;
const wordObj = WORDS[Math.floor(rng(seed)*WORDS.length)];
const word = wordObj.word.toUpperCase();
const theme = wordObj.theme;

/* ---------- UI ---------- */
const timerLine = document.getElementById("timerLine");
const themeLine = document.getElementById("themeLine");
const board = document.getElementById("board");
const input = document.getElementById("input");
const validate = document.getElementById("validate");
const msg = document.getElementById("msg");
const copyBtn = document.getElementById("copy");
const app = document.querySelector(".app");

themeLine.textContent = `HINT: ${theme} â€¢ ${word.length} letters`;

/* ---------- STATS ---------- */
const statsKey = "themeWordleStats";
let stats = JSON.parse(localStorage.getItem(statsKey)) || {
  played:0, wins:0, streak:0
};

function renderStats(){
  document.getElementById("played").textContent = stats.played;
  document.getElementById("wins").textContent = stats.wins;
  document.getElementById("streak").textContent = stats.streak;
  document.getElementById("rate").textContent =
    stats.played ? Math.round(stats.wins / stats.played * 100) : 0;
}
renderStats();

/* ---------- GAME ---------- */
const maxTries = 4;
let tries = 0;
let emojis = [];

const gameKey = `themeWordleGame-${dateKey}-${intervalIndex}`;
const lastPlayKey = "lastPlayInterval";

/* ---------- BOARD ---------- */
for (let i=0;i<maxTries;i++){
  const row=document.createElement("div");
  row.className="row";
  row.style.gridTemplateColumns=`repeat(${word.length},1fr)`;
  for(let j=0;j<word.length;j++) row.appendChild(document.createElement("div")).className="cell";
  board.appendChild(row);
}

/* ---------- RESTORE ---------- */
const saved = JSON.parse(localStorage.getItem(gameKey));
if(saved){
  tries=saved.tries;
  emojis=saved.emojis;
  saved.rows.forEach((r,i)=>{
    r.forEach((c,j)=>{
      const cell=board.children[i].children[j];
      cell.textContent=c.letter;
      cell.classList.add(c.state);
    });
  });
  input.disabled=true;
  validate.disabled=true;
  copyBtn.classList.remove("hidden");
  msg.textContent="ðŸ˜Ž You've already played. Share to your friends and come back at the next word!";
}

/* ---------- END GAME ---------- */
function endGame(win){
  input.disabled=true;
  validate.disabled=true;
  copyBtn.classList.remove("hidden");
  localStorage.setItem(lastPlayKey,`${dateKey}-${intervalIndex}`);

  stats.played++;
  if(win){ stats.wins++; stats.streak++; msg.textContent="You win!"; app.classList.add("win"); }
  else{ stats.streak=0; msg.textContent=`Word was: ${word}`; app.classList.add("lose"); }

  localStorage.setItem(statsKey,JSON.stringify(stats));
  renderStats();
}

/* ---------- SHARE ---------- */
copyBtn.onclick=()=>{
  navigator.clipboard.writeText(`Theme Wordle\n${emojis.join("\n")}\nNo spoilers`);
  msg.textContent="Copied to clipboard!";
};

/* ---------- TIMER ---------- */
function updateTimer(){
  const now=new Date();
  const next=new Date(now);
  now.getHours()<12 ? next.setHours(12,0,0,0) : (next.setDate(next.getDate()+1),next.setHours(0,0,0,0));
  const d=next-now;
  timerLine.textContent=`â³ Next word in ${String(d/36e5|0).padStart(2,"0")}:${String(d/6e4%60|0).padStart(2,"0")}:${String(d/1e3%60|0).padStart(2,"0")}`;
}
updateTimer();
setInterval(updateTimer,1000);
</script>

</body>
</html>
